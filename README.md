Zad3
====

#include &lt;iostream> #include &lt;cstdlib> #include &lt;ctime> #include &lt;string> #include &lt;Windows.h> #include "Polje.h" using namespace std;   struct petorka{ 	short a,b,c,d,e; } *pet;   datum danasDat;  unsigned short glRed, uputniceRecepti, trecina;    const  short loseKombinacije_cd[][2]  = { {1, 3}, {1, 4} };			 const short loseKombinacije_ce[][2] = { {1,1}, {3, 5} };			 const short loseKombinacije_de[][3] = { {3,2}, {3,3}, {3,4}, {3,5},   										{4,2}, {4,3}, {4,4}, {4,5},	 									  };    bool DobraKombinacija(petorka pet){ 	 	for(int i=0; i&lt;2; i++){ 		if( (pet.c == loseKombinacije_cd[i][0]) &amp;&amp; (pet.d == loseKombinacije_cd[i][1]) )		 			return false; 		else if( (pet.c == loseKombinacije_ce[i][0]) &amp;&amp; (pet.e == loseKombinacije_ce[i][1]) )	 			return false; 	} 	for(int i=0; i&lt;8; i++){ 		if((pet.d == loseKombinacije_de[i][0]) &amp;&amp; (pet.e == loseKombinacije_de[i][1]) )			 			return false; 	} 	return true;  }    void GeneriranjePetorke(petorka &amp;pet){  	pet.a = (rand() % 251)+50;  	pet.b = (rand() % 251)+50;  	do{ 		pet.c = (rand() % 5) +1;  		pet.d = (rand() % 4) +1;  		pet.e = (rand() % 5)+1;	 	 	}while(! DobraKombinacija(pet) );	  }    bool ValjanDan(short dan, short mj, short god){ 	 	if( (dan > 31) || (dan &lt; 1) ) 		return false;  	else if(mj == 2){ 		if( (god % 4 == 0) &amp;&amp; (dan > 29) )  			return false; 		else if( (god % 4 != 0) &amp;&amp; (dan > 28) )  			return false; 	}  	else if( (mj == 4) || (mj == 6) || (mj == 9) || (mj == 11) ){ 		if( dan > 30) 			return false; 	} 	else 		return true; }    void Unos(pacijent &amp;p){ 	cout &lt;&lt; "Ime i prezime: "; getline(cin, p.prezIme);  	cout &lt;&lt; "Datum rodjenja:
	Godina: ";  cin >> p.dat.godina; 	 	cout &lt;&lt; "	Mjesec: ";  	do{ 		cin >> p.dat.mjesec; 	}while( (p.dat.mjesec &lt; 1) || (p.dat.mjesec > 12) ); 	 	cout &lt;&lt; "	Dan: ";  	do{ 		cin>> p.dat.dan; 	}while( ! ValjanDan(p.dat.dan, p.dat.mjesec, p.dat.godina) ); 	 	cout &lt;&lt; "Spol (m - musko, z - zensko): "; 	do{ 		cin >> p.spol; 	}while( (p.spol != 'm') &amp;&amp; (p.spol != 'z') ); 	 	cout &lt;&lt; "Prioritet (1-5): "; 	if( (p.spol == 'm') &amp;&amp; (p.brGod &lt; 6)){  		do{ 			 cin >> p.c; 			 if(p.c == 3) 				 cout &lt;&lt; "
Cak i uz danasnju tehnologiju je nemoguce da muskarac zatrudni!
"; 		}while( (p.c &lt; 1) || (p.c > 5) || (p.c == 3) ); 	} 	else if(p.brGod >= 6){ 		do{ 			cin >> p.c; 			cout &lt;&lt; "Pa nije dijete mladje od 6 godina..." &lt;&lt; endl; 		}while( p.c == 4); 	} 	else{ 		do{ 			 cin >> p.c; 		}while( (p.c &lt; 1) || (p.c > 5) ); 	} 	 	cout &lt;&lt; "Vrsta usluge(1-4): "; 	do{ 		cin >> p.d; 	}while( (p.d &lt; 1) || (p.d > 4) ); 	 	cout &lt;&lt; "Ordinacija(1-5): "; 	if(p.spol == 'm'){  		do{ 			cin >> p.e; 			if(p.e == 4) 				cout &lt;&lt; "
Muskarci obicno ne idu kod ginekologa...
"; 		}while( (p.e &lt; 1) || (p.e > 5) || (p.e == 4)); 	} 	else{  		do{ 			cin >> p.e; 			if(p.e == 4) 				cout &lt;&lt; "
Zene obicno ne idu kod urologa...
"; 		}while( (p.e &lt; 1) || (p.e > 5) || (p.e == 5)); 	} 	 	 	p.brGod = danasDat.godina - p.dat.godina - 1; 	if(p.dat.mjesec >= danasDat.mjesec) 		p.brGod++; 	else if( (p.dat.mjesec == danasDat.mjesec) &amp;&amp; (p.dat.dan >= danasDat.dan) ) 		p.brGod++;  	if( (p.d == 3) || (p.d == 4) ) 		uputniceRecepti++;  }    string Usluga(short u){ 	switch(u){ 		case 1: return "pregled"; 		case 2: return "previjanje"; 		case 3: return "recepti"; 		case 4: return "uputnice"; 	} }    string Prioritet(short u){ 	switch(u){ 		case 1: return "hitno"; 		case 2: return "invalid"; 		case 3: return "trudnica"; 		case 4: return "djeca &lt;6 godina"; 		case 5: return "ostali"; 	} }    string Ordinacija(short u){ 	switch(u){ 		case 1: return "obiteljska medicina"; 		case 2: return "oftalmologija"; 		case 3: return "dermatovenerologija"; 		case 4: return "ginekologija"; 		case 5: return "urologija"; 	} }    void Ispis(pacijent p){ 	cout &lt;&lt; "
-------------------------------------------------" &lt;&lt; endl; 	cout &lt;&lt; "Ime i prezime: " &lt;&lt; p.prezIme &lt;&lt; endl; 	cout &lt;&lt; "Datum rodjenja: " &lt;&lt; p.dat.dan &lt;&lt; "." &lt;&lt;  p.dat.mjesec &lt;&lt;"." &lt;&lt; p.dat.godina &lt;&lt; endl; 	cout &lt;&lt; "Broj godina: " &lt;&lt; p.brGod &lt;&lt; endl; 	cout &lt;&lt; "Spol: "&lt;&lt; p.spol &lt;&lt; endl; 	cout &lt;&lt; "Prioritet: "&lt;&lt; Prioritet(p.c) &lt;&lt; endl; 	cout &lt;&lt; "Vrsta usluge: " &lt;&lt; Usluga(p.d) &lt;&lt; endl; 	cout &lt;&lt; "Ordinacija: " &lt;&lt; Ordinacija(p.e) &lt;&lt; endl; }    void UnosPacijenta(Queue *q,  petorka *pet, int n){  	pacijent p; 	for(int i=0; i&lt;n; i++){ 		p.prezIme = "pacijent"; 		char str[5]; 		itoa(i+1, str, 10);  		p.prezIme += str;	 		p.a = pet[i].a; 		p.b = pet[i].b; 		p.c = pet[i].c; 		p.d = pet[i].d; 		p.e = pet[i].e; 		if( (p.c == 3) || (p.e == 4) )  			p.spol = 'z'; 		else if(p.e == 5)	 			p.spol = 'm'; 		else{  			if((rand() % 3) == 1) 				p.spol = 'm'; 			else 				p.spol = 'z'; 		} 		p.brGod = (rand()%40) + 20;  		p.dat.dan = 1; 		p.dat.mjesec = 1; 		p.dat.godina = danasDat.godina - p.brGod; 		EnQueue(q, p); 	} }    void UnosPacijenta(Queue *q){  	pacijent p; 	cin.ignore(); 	Unos(p); 	EnQueue(q, p); }     void PacijenticeKodOftalmologa(Queue *q){  	pacijent p; 	Queue *pom = new Queue;  	InitQ(pom);  	 	do{ 		p = FrontQ(q); 		if( (p.spol == 'z') &amp;&amp; (p.brGod > 25) &amp;&amp; (p.d == 1) &amp;&amp; (p.e == 2))  			Ispis(p); 		EnQueue(pom, p); 		DeQueue(q); 	}while( !IsEmptyQ(q) ); 	 	do{ 		p = FrontQ(pom); 		EnQueue(q, p); 		DeQueue(pom); 	}while( !IsEmptyQ(pom) );  	delete pom; }    void IspisReda(Queue *q, bool glavni){ 	pacijent p; 	Queue *pom = new Queue;  	InitQ(pom);  	if(glavni) 		cout &lt;&lt; "Ispis glavnog reda:
" &lt;&lt; endl; 	else 		cout &lt;&lt; "Ispis brzog reda:
" &lt;&lt; endl;  	 	do{ 		p = FrontQ(q); 		Ispis(p); 		EnQueue(pom, p); 		DeQueue(q); 	}while( !IsEmptyQ(q) ); 	do{ 		p = FrontQ(pom); 		EnQueue(q, p); 		DeQueue(pom); 	}while( !IsEmptyQ(pom) );  	delete pom; }     void Invalidi(Queue *q){  	pacijent p; 	Queue *pom = new Queue;  	InitQ(pom);  	 	do{ 		p = FrontQ(q); 		if ( (p.spol == 'm') &amp;&amp; (p.brGod > 50) &amp;&amp; (p.c == 2) &amp;&amp; (p.d == 2) &amp;&amp; (p.e == 1) )  			glRed--;  		else  			EnQueue(pom, p);	 		DeQueue(q); 	}while( !IsEmptyQ(q) ); 	  	do{ 		p = FrontQ(pom); 		EnQueue(q, p); 		DeQueue(pom); 	}while( !IsEmptyQ(pom) );  	IspisReda(q, true);  	delete pom; }     void Sort(pacijent *p){ 	bool zamj; 	for(int i=0; i&lt;glRed; i++){ 		zamj = false; 		for(int j=0; j&lt;glRed-i-1; j++){ 			if(p[j].c > p[j+1].c){ 				pacijent pom = p[j]; 				p[j] = p[j+1]; 				p[j+1] = pom; 				zamj = true; 			} 			else if( (p[j].c == p[j+1].c) &amp;&amp; (p[j].a > p[j+1].a)){ 				pacijent pom = p[j]; 				p[j] = p[j+1]; 				p[j+1] = pom; 				zamj = true; 			} 		} 		if(!zamj) break;  	} }    void Sort(Queue *q){ 	pacijent *p = new pacijent[glRed]; 	int i=0; 	do{ 		p[i] = FrontQ(q); 		DeQueue(q); 		i++; 	}while( !IsEmptyQ(q) ); 	Sort(p); 	for(i=0; i&lt;glRed; i++) 		EnQueue(q, p[i]); }    void NoviRed(Queue *glavni, Queue *brzi, int i, int length, int upRec, int trecina){  	static pacijent *spremnik = new pacijent[length]; 	spremnik[i] = FrontQ(glavni); 	DeQueue(glavni); 	if(i &lt; length-1) 		NoviRed(glavni, brzi, i+1, length, upRec, trecina);  	if(i == 0){ 		int x = 0; 		for(int j=0; j&lt;length; j++){ 			if( (spremnik[j].d == 3) || (spremnik[j].d == 4) ){ 				x++; 				if(x > (upRec - trecina)) 					EnQueue(brzi, spremnik[j]); 				else 					EnQueue(glavni, spremnik[j]); 			} 			else 				EnQueue(glavni, spremnik[j]); 		} 	}  }         int main(){  	glRed = 0; 	uputniceRecepti = 0; 	trecina = 0; 	srand(time(0)); 	time_t t = time(0); 	struct tm *dat = localtime(&amp;t); 	danasDat.dan = dat->tm_mday; 	danasDat.mjesec = dat->tm_mon + 1; 	danasDat.godina = dat->tm_year + 1900;  	int n; 	cout &lt;&lt; "
Broj uredjenih petorki: "; 	do{ 		cin >> n; 		if(n&lt;=1) cout &lt;&lt; "Krivi unos!

Broj uredjenih cetvorki: "; 	}while(n&lt;=1); 	pet = new petorka[n];  	glRed = n;  	for(int i=0; i&lt;n; i++){ 		GeneriranjePetorke(pet[i]); 		if( (pet[i].d == 3) || (pet[i].d == 4) ) 			uputniceRecepti++; 	} 	 	Queue *q = new Queue; 	Queue *brzi = new Queue; 	InitQ(q); InitQ(brzi); 	UnosPacijenta(q, pet, n); 	Sort(q);  	char izb; 	system ("cls"); 	do{ 		cout &lt;&lt; "
1. Dodavanje novog pacijenta
2. Invalidi idu na previjanje " &lt;&lt; endl; 		cout &lt;&lt; "3. Red brzih usluga
0. Izlaz "; 		cout &lt;&lt; endl &lt;&lt; "
	Izbor: "; 		cin >> izb; 		system ("cls"); 		 		switch(izb){ 			case '0': { return 0; } 			case '1': { 						  cout &lt;&lt; "Klijent br. " &lt;&lt; glRed + 1 &lt;&lt; ":
" &lt;&lt; endl; 						  UnosPacijenta(q); 						  glRed = glRed+1; 						  cout &lt;&lt; endl; 						  Sort(q); 						  PacijenticeKodOftalmologa(q); 						  break; 					  } 			case '2': {	 						  Invalidi(q); 						  break; 					  } 			case '3': { 						trecina = uputniceRecepti/3;  						NoviRed(q, brzi, 0, glRed, uputniceRecepti, trecina);  						IspisReda(q, true); 						 						system("pause"); 						system("cls");  						if( IsEmptyQ(brzi) ) 							cout &lt;&lt; "Prazan je.."; 						else 							IspisReda(brzi, false);  						glRed -= trecina; 						uputniceRecepti -= trecina; 						break;						 					  } 			default: { cout &lt;&lt; "Krivi unos!" &lt;&lt; endl; } 		} 		 		cout &lt;&lt; "
   Pritisnite bilo koju tipku na nastavak..." &lt;&lt; endl; 		system("pause"); 		system ("cls"); 	}while(1); }
